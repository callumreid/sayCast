# sayCast Productionalization Plan

**Last Updated**: 2025-11-12

## Overview
This document outlines the complete plan to take sayCast from a personal tool to a production-ready application distributable via Homebrew for macOS users.

## Distribution Target
- **Primary Channel**: Homebrew (homebrew-saycast tap)
- **Secondary Channel**: Direct DMG downloads (future)
- **Auto-Updates**: Sparkle framework (Phase 2)
- **License**: Free
- **Target Users**: macOS users with Raycast installed

## Productionalization Phases

### Phase 1: CI/CD & Release Infrastructure (CURRENT)

#### Objectives
- ✅ Set up GitHub Actions workflows for automated builds
- ✅ Implement universal binary builds (Intel + Apple Silicon)
- ✅ Code signing & notarization automation
- ✅ Automated release creation on GitHub
- ✅ Homebrew tap repository setup and automation

#### Deliverables
- `.github/workflows/build-release.yml` - Main build and release workflow
- `homebrew-saycast/` - Tap repository with formula
- GitHub release artifacts with signed/notarized binaries
- Automated version management from git tags

#### Configuration Required
```
APPLE_DEVELOPER_ID_APPLICATION: "Developer ID Application: Your Name (TEAM_ID)"
APPLE_DEVELOPER_ID_INSTALLER: "Developer ID Installer: Your Name (TEAM_ID)"
APPLE_NOTARIZATION_TEAM_ID: <team_id>
APPLE_NOTARIZATION_USER: <apple_id_email>
APPLE_NOTARIZATION_PASSWORD: <app_specific_password> (via GitHub Secrets)
GITHUB_TOKEN: (auto-populated by GitHub Actions)
```

---

### Phase 2: User Settings & Configuration UI (NEXT)

#### Objectives
- ✅ Add preferences window to HUD app
- ✅ Store user API keys (Wispr, OpenAI) securely in Keychain
- ✅ Allow custom command configuration through UI
- ✅ Settings persistence in ~/Library/Application Support/sayCast/

#### Deliverables
- Preferences/Settings React component
- Keychain integration for API secrets
- Custom commands editor UI
- Config import/export functionality

#### User-Facing Features
- API key input fields (password-protected)
- Custom command YAML editor or form builder
- Audio test button (capture and transcribe)
- Log viewer/exporter

---

### Phase 3: Auto-Updates (Phase 2+)
**Timeline**: 1-2 weeks

#### Objectives
- Implement Sparkle framework for seamless auto-updates
- Delta updates to minimize download size
- Update notifications in HUD

#### Deliverables
- Sparkle configuration in Electron app
- Signed update feeds
- Update prompt UI

---

### Phase 4: Installation & Onboarding (User-Driven)
**Timeline**: Ongoing

#### User-Facing Content
- Installation guide (Homebrew command)
- First-run setup wizard
- Permission granting flow (microphone + accessibility)
- Video tutorial
- Troubleshooting guide

---

## Build & Release Workflow

### Version Management
- **Source**: Git tags in format `v{major}.{minor}.{patch}` (e.g., `v0.2.0`)
- **CI Trigger**: Pushing tag automatically triggers build + release
- **Versioning Rule**: Update `package.json` version before tagging

### Build Steps (GitHub Actions)
1. Checkout code
2. Install dependencies (pnpm)
3. Build TypeScript packages
4. Build Swift helper (universal binary)
5. Build Electron app (universal binary)
6. Create DMG installer (later)
7. Code sign all binaries
8. Notarize with Apple
9. Generate GitHub release with artifacts
10. Update Homebrew tap formula with new SHA256/URL

### Artifact Naming Convention
```
sayCast-{version}-{arch}.tar.gz
sayCast-{version}-universal.tar.gz
sayCast-{version}-{version}.dmg (future)
```

---

## Homebrew Distribution

### Setup
1. Create separate `homebrew-saycast` repository on GitHub
2. Formula file: `Formula/saycast.rb`
3. Continuous updates via CI/CD

### Formula Structure
```ruby
class Saycast < Formula
  desc "Voice-controlled Raycast commands on macOS"
  homepage "https://github.com/yourusername/sayCast"
  url "https://github.com/yourusername/sayCast/releases/download/v0.2.0/sayCast-0.2.0-universal.tar.gz"
  sha256 "<calculated_from_artifact>"
  
  depends_on :macos => ">= 12"
  depends_on "raycast" # via brew-formulae or cask
  
  def install
    bin.install "sayCast"
    # LaunchAgent installation script
    system "#{bin}/saycast-install-agent"
  end
end
```

### User Installation
```bash
brew tap yourusername/homebrew-saycast
brew install saycast
```

### Update Process
- Users run: `brew upgrade saycast`
- Formula automatically updated via CI/CD on each release

---

## Configuration & Data Directories

### Directory Structure
```
~/Library/Application Support/sayCast/
├── config.json              # User settings (API keys excluded)
├── commands.yaml            # Custom commands
└── themes.json              # UI theme preferences

~/Library/Logs/sayCast/
├── main.log                 # Main app logs
├── audio.log                # Audio processing logs
└── transcription.log        # STT service logs

~/Library/LaunchAgents/
└── com.saycast.agent.plist  # LaunchAgent for auto-start
```

### Secure Storage (Keychain)
- Wispr API key
- OpenAI API key
- Any user credentials

---

## Key Environment Variables for Production

### Required (User Provides)
```
WISPR_API_KEY=<user_wispr_key>
OPENAI_API_KEY=<user_openai_key_optional>
```

### Build-Time (CI/CD)
```
APPLE_DEVELOPER_ID_APPLICATION=...
APPLE_DEVELOPER_ID_INSTALLER=...
APPLE_NOTARIZATION_TEAM_ID=...
APPLE_NOTARIZATION_USER=...
APPLE_NOTARIZATION_PASSWORD=... (GitHub Secret)
```

### Runtime (Auto-Set)
```
SAYCAST_VERSION=<from_package.json>
SAYCAST_HOME=~/Library/Application Support/sayCast
SAYCAST_LOGS=~/Library/Logs/sayCast
```

---

## Pre-Release Checklist

Before releasing v1.0.0:

### Code Quality
- [ ] All tests passing
- [ ] Linting passes (`pnpm lint`)
- [ ] No console errors/warnings
- [ ] TypeScript strict mode enabled
- [ ] Error handling comprehensive

### Security
- [ ] API keys stored in Keychain (not plaintext)
- [ ] No credentials in logs
- [ ] Code signed properly
- [ ] Notarized successfully
- [ ] No shell injection vulnerabilities

### User Experience
- [ ] Settings UI complete and tested
- [ ] First-run permissions flow working
- [ ] HUD overlay stable
- [ ] Command matching accurate
- [ ] Error messages user-friendly

### Documentation
- [ ] README updated
- [ ] Installation guide ready
- [ ] API key setup instructions
- [ ] Command configuration guide
- [ ] Troubleshooting section
- [ ] GitHub wiki populated

### Release
- [ ] Version bumped in package.json
- [ ] CHANGELOG.md updated
- [ ] Git tag created (`v1.0.0`)
- [ ] GitHub Actions CI/CD passes
- [ ] Homebrew formula published
- [ ] Verified installation via Homebrew works

---

## Success Metrics (Post-Release)

- GitHub stars/forks
- Homebrew install count (via analytics)
- User feedback/issues
- Feature requests
- Eventual paid tier feasibility

---

## Long-Term Roadmap

### v1.0
- Core voice control via Raycast
- Homebrew distribution
- Basic settings UI

### v1.5+
- Sparkle auto-updates
- Advanced command templates
- Analytics dashboard (for you)
- DMG installer
- App Store release (if feasible)

### v2.0
- Multi-monitor support
- Custom voice shortcuts
- Community command sharing
- Desktop app notifications
- Offline mode with local Whisper

---

## Critical Contacts & Resources

- **Apple Developer Account**: Already set up ✅
- **GitHub**: Repository ready ✅
- **Homebrew Tap**: To be created
- **Certificate Management**: Use Xcode Keychain

---

## Notes

- Keep main repo as source of truth
- Use semantic versioning strictly
- Test DMG installer before public release
- Consider private beta with a few users first
- Monitor error logs closely in early releases

